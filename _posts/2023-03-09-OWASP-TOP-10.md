---
title: OWASP Top 10
author: butzee
date: 2023-03-09
categories: [Vulnerabilities, OWASP]
tags: [Injection,
    Broken Authentication,
    Sensitive Data Exposure,
    XML External Entity,
    Broken Access Control,
    Security Misconfiguration,
    Cross-site Scripting,
    Insecure Deserialization,
    Components with Known Vulnerabilities,
    Insufficent Logging & Monitoring]
render_with_liquid: false
---
## OWASP Top 10

<details>
	<summary>Sources</summary>    
	TryHackMe: <a href="https://tryhackme.com/room/owasptop10">Further Nmap</a> - Learn about and exploit each of the OWASP Top 10 vulnerabilities; the 10 most critical web security risks.
</details>

This post contains information regarding the Top 10 vulnerabilities from OWASP gathered from the corresponding TryHackMe Room. Nevertheless there are going to be more posts in the future containing more detailed information about the specifics of these vulnerabilities. That being said, have fun with the small insight to the Top 10 from OWASP.

## Severity 1 - Injection

Common injection examples:
- SQL-Injection
- Command Injection
    - active: returns response to user
    - blind: returns no response to user
Both injections change the intended and allowed way to execute code and therefore alow the execution of an arbitrary command.

Defense:
- Stripping dangerous characters from the input before processing
- Checking input for safe characters (White-Listing)

If server-side code like php makes an system call in a web application, a command injection occurred. Mostly it is used to create a reverse shell.

## Severity 2 - Broken Authentication

Flaws in authentication mechanisms:
- Brute force attacks (guessing username + password - multiple attemps)
- Use of weak credentials (easy to guess)
- Weak Session Cookies (Changing Values to other users)

Sanitization is also important. Sometimes you can re-registrate an existing user if you just add an empty space at the beginning of the name.

## Severity 3 - Sensitive Data Exposure

Flat-file databases are good, because they are easy to set up and pretty small for web applications. But on the other hand they can sometimes be downloaded and in that case the attacker hast access to all information.

Some simple sqlite3 commands:

|Command|Explanation|
|------|------|
|sqlite3 \<database-name\> | Open the database. |
| .tables | Show tables of database. |
| PRAGMA table_info(\<table-name\>); | List table-information.|

## Severity 4 - XML External Entity 

XE attacks:
- in-band XXE attack: attacker receives response to the XXE payload
- out-of-band XXE attacks: no response - output to some other file

XML:
- needs Root-Element
- is case-sensitive
- Elements can have attributes too
- DTD defines the structure and the legal elements and attributes

XXE-Payload to read file from system:
```XML
<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY read SYSTEM 'file:///path/to/file'>]>
<root>&read;</root>
```

## Severity 5 - Broken Access Control

Allows attackers to bypass authorization which can allow them to view sensitive data or perform tasks as if they were a privileged user.

OWASP - attack scenarios:
- Unverified data in a SQL call that is accessing account information.
- Force browsing to target URL.

Insecure Direct Object Reference: Referencing Object in the URL.

## Severity 6 - Security Misconfiguration

List of misconfigurations:
- permissions on cloud services
- unnecessary features enabled
- Default accounts with unchanged passwords
- overly detailed Error messages
- Not using HTTP security headers

Hint: Look for default credentials in accessible documentation.

## Severity 7 - Cross-site Scripting

Web-Application is vulnerable to XSS if it uses unsanitized input:
- Stored XSS
- Reflected XSS
- DOM-based XSS

For example you can write the following in XSS vulnerable chat:
```JavaScript
<script>document.getElementById('something').innerHTML="Changed Value";</script>
```
In the following repo are good payloads to findTryHackMe: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection">Payloads</a>.

## Severity 8 - Insecure Deserialization

In that case there is data replaced with malicious code which the application processes.

## Severity 9 - Components With Known Vulnerabilities

Read on exploit-db.com for found services. That way you can easily find known vulnerabilities.

## Severity 10 - Insufficient Logging and Monitoring 

Most important information in logs:
- HTTP status codes
- Time Stamps
- Usernames
- API endpoints/page locations
- IP addresses